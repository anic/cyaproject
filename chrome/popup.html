<!DOCTYPE>
<html>
	<head>
		<title>工具目录</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<link href="css/transdmin.css" rel="stylesheet" type="text/css" media="screen">
		<script type="text/javascript" src="js/jquery.js"></script>
		<script type="text/javascript" src="js/login.js"></script>
		<script type="text/javascript" src="js/jNice.js"></script>
		<script type="text/javascript">
			$(function() {
				// var bg = chrome.extension.getBackgroundPage();
				// $("#description").append(bg.gExInfo.description);
				window.testLogin(function(result) {
					if(result) {
						onLoginSuccess(result);
					}
					else
					{
						$("#btnLogin").html("<< 请登录  >>");
					}
				});
			});
			function menuLogin() {
				$("#btnLogin").css("color", "orange").html("登录中...");
				window.testLogin(function(result) {
					if(result) {
						onLoginSuccess();
					} else {
						var bg = chrome.extension.getBackgroundPage();
						var name = bg.setting("PortalName");
						var pwd = bg.setting("PortalPwd");
						if(name && pwd) {
							window.login(name, pwd, onLoginSuccess);
						} else
							$("#btnLogin").css("color", "red").html("未设置用户名密码");
					}
				})
			}

			function onLoginSuccess(result) {
				if(result) {
					$("#btnLogin").css("color", "green").html("OA已登录")[0].onclick = null;
					$("#btnLogin").append("<img src='image/popup/check.png'>");
				} else {
					$("#btnLogin").css("color", "red").html("登录失败");
				}
			}

			function openTab(url) {
				chrome.tabs.create({
					url : url
				});
			}
		</script>
	</head>
	<body style="width:180px">
		<!--
		参考：http://codecanyon.net/item/drop-menu/full_screen_preview/81289?ref=1stwebdesigner&clickthrough_id=38287307&redirect_back=true&ref=1stwebdesigner
		-->
		<div class="sidebar">
			<ul class="sideNav">
				<li>
					<a href="#" onclick="menuLogin()" id="btnLogin">登录</a>
				</li>
				<li>
					<a href="http://pac.gmcc.net/portal/dt?DISHI_Portal.setSelected=DISHI_guangzhou_workbench1&last=false&provider=DISHI_Portal" target="_blank">工作台</a>
				</li>
				<li>
					<a href="app/contact/contact.html" target="_blank">离线通讯录</a>
				</li>
				<li>
					<a href="http://contacts.services.gmcc.net/UserInfoSimple.aspx?nid=61ca46b7-0b76-41ae-9e1a-cd9adba8c86c&sid=11&f=app" target="_blank">省通讯录</a>
				</li>
				<li>
					<a href="http://lsp2.gz.gmcc.net/OffCommunicate/adress.aspx" target="_blank">市通讯录</a>
				</li>
				<li>
					<a href="feature.html" target="_blank">设置</a>
				</li>
			</ul>
			<!-- // .sideNav -->
		</div>
	</body>
</html>
